function s_AutoSegmentaionFreeSurf
% (courtesy of Dr. JW)
tamagawahomedir = '/biac4/wandell/biac2/wandell/data/DWI-Tamagawa-Japan';

%% navigate to direcotry containing new T1s
subnames = {...
    %     'JMD1-MM-20121025-DWI'...
    %     'JMD2-KK-20121025-DWI'...
    %     'JMD3-AK-20121026-DWI'...
    %     'JMD4-AM-20121026-DWI'...
    %     'JMD5-KK-20121220-DWI'...
    %     'JMD6-NO-20121220-DWI'...
    %     'JMD7-YN-20130621-DWI'...
    %     'JMD8-HT-20130621-DWI'...
    %     'JMD9-TY-20130621-DWI'...
    %     'LHON1-TK-20121130-DWI'...
    %     'LHON2-SO-20121130-DWI'...
    %     'LHON3-TO-20121130-DWI'...
    %     'LHON4-GK-20121130-DWI'...
    %     'LHON5-HS-20121220-DWI'...
    %     'LHON6-SS-20121221-DWI'...
    %     'JMD-Ctl-MT-20121025-DWI'...
    %     'JMD-Ctl-YM-20121025-DWI'...
    %     'JMD-Ctl-SY-20130222DWI'...
    %     'JMD-Ctl-HH-20120907DWI'...
    %     'JMD-Ctl-HT-20120907-DWI'...
    %     'JMD-Ctl-FN-20130621-DWI'...
    %     'JMD-Ctl-AM-20130726-DWI'...
    %     'JMD-Ctl-SO-20130726-DWI'...
    %     'RP1-TT-2013-11-01'
    %     'RP2-KI-2013-11-01'
    % 'RP3-TO-13120611-DWI'
%     'RP4-AK-2014-01-31'
%     'RP5-KS-2014-01-31'
% 'JMD3-AK-20140228-dMRI'
%     'JMD-Ctl-09-RN-20130909'
% 'JMD-Ctl-10-JN-20140205'
% 'JMD-Ctl-11-MT-20140217'
% 'RP6-SY-2014-02-28-dMRI'
%     'Ctl-12-SA-20140307'
%     'Ctl-13-MW-20140313-dMRI-Anatomy'
%     'Ctl-14-YM-20140314-dMRI-Anatomy'
%     'RP7-EU-2014-03-14-dMRI-Anatomy'
%     'RP8-YT-2014-03-14-dMRI-Anatomy'
    'LHON6-SS-20131206-DWI'
};


%% If you want to segment several subject simultaneously. It would be 
% better to use matlabpool. matlabpool OPEN <number of core>.
% matlabpool OPEN 4;


%%
parfor subinds =1:length(subnames);
    
    cd(fullfile(tamagawahomedir, subnames{subinds}))
    
    %% autosegmentation with freesurfer
    subjID = subnames{subinds};
    t1  = 't1.nii.gz';
    fs_autosegmentToITK(subjID, t1)
end   
    %% memo to solve a minor bag
    % if you will still have any problem above and you can find automatic
    % segmented  file in freesurfer folder
    % (i.e. /[tamagawadatapath]/freesurfer/[subject]/mri/ribon.mgz)
    %
    % please run a script below
    % if you will still have any problem above and you can find automatic segmented
%     outfile     = fullfile(fileparts(t1),...
%         sprintf('t1_class_fs_%s.nii.gz',  datestr(now, 'yyyy-mm-dd-HH-MM-SS')));
%     fillWithCSF = true;
%     alignTo     = t1;
%     
%     fs_ribbon2itk(subjID, outfile, fillWithCSF, alignTo);
% end

% matlabpool close;